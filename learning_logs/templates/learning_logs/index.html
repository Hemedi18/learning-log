{% extends "learning_logs/base.html" %}

{% block content %}
<div class="container animate-fade-in">
    {% if user.is_authenticated %}
        <!-- Header -->
        <div style="margin-bottom: 2rem;">
            <h1 style="font-size: 2rem;">Karibu, <span style="color: var(--primary);">{{ user.username }}</span></h1>
            <p style="color: var(--text-dim);">Hapa kuna muhtasari wa siku yako.</p>
        </div>

        <!-- Notifications -->
        {% if notifications %}
        <div class="notification-list">
            {% for note in notifications %}
            <div class="notification-item">
                <div class="notification-content">
                    <i class="fas fa-bell"></i>
                    <span>{{ note }}</span>
                </div>
                <a href="{% url 'learning_logs:new_expense' %}" class="btn btn--primary" style="font-size: 0.75rem; padding: 0.5rem 1rem;">Weka Sasa</a>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Financial Dashboard Grid -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3 class="h4" style="margin: 0;">Hali ya Fedha</h3>
            <a href="{% url 'learning_logs:expenses' %}" style="font-size: 0.9rem;">Ripoti Kamili <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <div class="dashboard-grid">
            <div class="stat-card-modern income">
                <span class="stat-label">Mapato (Mwezi)</span>
                <div class="stat-value">TZS {{ total_income|floatformat:0 }}</div>
                <i class="fas fa-arrow-up" style="position: absolute; right: 1.5rem; top: 1.5rem; font-size: 1.5rem; color: rgba(0, 184, 148, 0.2);"></i>
            </div>
            <div class="stat-card-modern expense">
                <span class="stat-label">Matumizi (Mwezi)</span>
                <div class="stat-value">TZS {{ total_expenses|floatformat:0 }}</div>
                <i class="fas fa-arrow-down" style="position: absolute; right: 1.5rem; top: 1.5rem; font-size: 1.5rem; color: rgba(255, 118, 117, 0.2);"></i>
            </div>
            <div class="stat-card-modern balance">
                <span class="stat-label">Baki (Akiba)</span>
                <div class="stat-value">TZS {{ balance|floatformat:0 }}</div>
                <i class="fas fa-wallet" style="position: absolute; right: 1.5rem; top: 1.5rem; font-size: 1.5rem; color: rgba(9, 132, 227, 0.2);"></i>
            </div>
        </div>

        <!-- Recent Entries -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; margin-top: 3rem;">
            <h3 class="h4" style="margin: 0;">Recent Diary Entries</h3>
            <a href="{% url 'learning_logs:entry_list' %}" style="font-size: 0.9rem;">View All <i class="fas fa-arrow-right"></i></a>
        </div>

        <div class="row">
            {% for entry in recent_entries %}
            <div class="col-md-4" style="margin-bottom: 1.5rem;">
                <div class="entry-card" style="height: 100%; display: flex; flex-direction: column;">
                    <div class="entry-card__header">
                        <h5 class="entry-card__title">{{ entry.title }}</h5>
                        <span class="entry-card__meta">{{ entry.date_created|date:"M d" }}</span>
                    </div>
                    <p style="color: var(--text-dim); font-size: 0.9rem; flex-grow: 1; margin-bottom: 1.5rem;">
                        {{ entry.content|striptags|truncatewords:15 }}
                    </p>
                    <a href="{% url 'learning_logs:entry_detail' entry.id %}" class="btn btn--outline" style="width: 100%; text-align: center;">Read Entry</a>
                </div>
            </div>
            {% empty %}
            <div class="col-12">
                <div style="text-align: center; padding: 3rem; background: var(--bg-surface-2); border-radius: 16px; border: 1px dashed var(--border-light);">
                    <p style="color: var(--text-dim); margin-bottom: 1rem;">No entries yet.</p>
                    <a href="{% url 'learning_logs:entry_create' %}" class="btn btn--primary">Write your first entry</a>
                </div>
            </div>
            {% endfor %}
        </div>

    {% else %}
        <!-- Guest Hero -->
        <div class="hero-container">
            <h1 class="hero-title">Personal Management<br>& Finance Tracker</h1>
            <p class="hero-subtitle">
                Master your life with our comprehensive suite of tools. Track your finances, journal your thoughts, and manage your schedule in one secure, beautiful interface.
            </p>
            <div class="hero-buttons">
                <a href="{% url 'users:register' %}" class="btn btn--primary" style="font-size: 1rem; padding: 1rem 2rem;">Get Started</a>
                <a href="{% url 'users:login' %}" class="btn btn--outline" style="font-size: 1rem; padding: 1rem 2rem;">Log In</a>
            </div>
        </div>
    {% endif %}
</div>
{% endblock content %}
