{% extends "learning_logs/base.html" %}

{% block page_header %}
<div class="calendar-header-bar">
    <h1 class="calendar-title">My Calendar</h1>
    <div class="calendar-controls">
        <!-- We parse the prev_month string (e.g., "month=2023-10") to get year/month for data attributes -->
        <button class="btn btn--icon js-calendar-nav js-nav-prev" 
                data-year="{{ prev_month|slice:'6:10' }}" 
                data-month="{{ prev_month|slice:'11:' }}">
            <i class="fas fa-chevron-left"></i> Prev
        </button>
        <button class="btn btn--outline js-calendar-nav js-nav-next" 
                data-year="{{ next_month|slice:'6:10' }}" 
                data-month="{{ next_month|slice:'11:' }}">
            Next <i class="fas fa-chevron-right"></i>
        </button>
        <button class="btn btn--primary ms-3" id="btn-new-event">
            <i class="fas fa-plus"></i> New Event
        </button>
    </div>
</div>
{% endblock page_header %}

{% block content %}
<div class="calendar-container">
    <div class="calendar-wrapper">
        {{ calendar|safe }}
    </div>
</div>

<!-- Event Modal -->
<div id="eventModal" class="modal-overlay">
    <div class="modal-content glass-effect">
        <div class="modal-header">
            <h3>Add Event</h3>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <form action="{% url 'learning_logs:entry_create' %}" method="post" id="eventForm">
                {% csrf_token %}
                <!-- We render fields manually to style them -->
                <div class="form-group">
                    <label>Title</label>
                    {{ form.title }}
                </div>
                <div class="form-group">
                    <label>Date & Time</label>
                    {{ form.event_date }}
                </div>
                <div class="form-group">
                    <label>Category (Mood)</label>
                    {{ form.mood }}
                </div>
                <div class="form-group">
                    <label>Description</label>
                    {{ form.content }}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn--outline close-modal">Cancel</button>
                    <button type="submit" class="btn btn--primary">Save Event</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}